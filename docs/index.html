<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0f172a" />
  <meta name="description" content="Cert Study Suite - CompTIA prep PWA for A+, Network+, and Security+" />
  <title>Cert Study Suite</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icons/icon-192.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="icons/icon-192.svg" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <div class="logo" aria-hidden="true">⚡️</div>
      <div>
        <h1>Cert Study Suite</h1>
        <p>Offline-friendly CompTIA prep</p>
      </div>
    </div>
    <div class="header-controls">
      <nav class="primary-nav" aria-label="Primary">
        <button class="nav-link active" data-target="dashboard">Dashboard</button>
        <button class="nav-link" data-target="flashcards">Flashcards</button>
        <button class="nav-link" data-target="quizzes">Quizzes</button>
        <button class="nav-link" data-target="pbqs">PBQs</button>
      </nav>
      <div class="account-actions">
        <span class="account-badge" id="accountBadge" aria-live="polite">Free tier</span>
        <button class="ghost subtle-button" id="authButton" type="button">Sign in</button>
        <button class="primary" id="headerUpgradeButton" data-upgrade="true" data-upgrade-label="Upgrade to Pro" data-upgrade-thanks="Pro active">Upgrade to Pro</button>
      </div>
    </div>
  </header>

  <main>
    <section id="dashboard" class="view active" aria-labelledby="dashboard-heading">
      <div class="hero-card" id="heroCard">
        <div>
          <p class="eyebrow">Welcome back</p>
          <h2 id="dashboard-heading">Ready to study?</h2>
          <p id="heroSubtext">Select a track below to begin.</p>
        </div>
        <div class="hero-actions">
          <button class="primary" id="continueButton" data-shortcut="true" disabled>Continue studying</button>
          <button class="ghost" id="switchTrackButton">Choose track</button>
        </div>
      </div>

      <p class="onboarding-hint" id="trackHint" role="status">Step 1: Tap a track card below to start.</p>

      <div class="overview-grid">
        <article class="overview-card" id="sessionCard">
          <div>
            <p class="eyebrow">Continue where you left off</p>
            <h3 id="sessionHeadline">Ready when you are</h3>
          </div>
          <dl class="session-stats">
            <div>
              <dt>Track</dt>
              <dd id="sessionTrack">No history yet</dd>
            </div>
            <div>
              <dt>Mode</dt>
              <dd id="sessionMode">—</dd>
            </div>
            <div>
              <dt>Updated</dt>
              <dd id="sessionUpdated">Never</dd>
            </div>
          </dl>
          <div class="session-actions">
            <button class="primary" data-target="flashcards" data-shortcut="true" id="resumeFlashcards" aria-disabled="true" disabled>Resume flashcards</button>
            <button class="ghost" data-target="quizzes" data-shortcut="true" id="resumeQuiz" aria-disabled="true" disabled>Jump into quiz</button>
          </div>
        </article>

        <article class="overview-card" id="progressCard">
          <div>
            <p class="eyebrow">Track confidence</p>
            <h3>Quick stats</h3>
          </div>
          <div class="analytics-stack">
            <ul id="questionSummary" class="progress-list">
              <li>Loading question counts…</li>
            </ul>
            <div class="weak-tag-summary" id="weakTagSummary">
              <p class="eyebrow">Adaptive focus</p>
              <p id="weakTagCopy">Complete a quiz to see your weakest domains.</p>
            </div>
          </div>
        </article>
      </div>
      <div id="trackCards" class="track-grid" aria-live="polite"></div>
    </section>

    <section id="flashcards" class="view" aria-labelledby="flashcards-heading">
      <header class="section-header">
        <div>
          <h2 id="flashcards-heading">Flashcards</h2>
          <p>Spaced repetition inspired practice. Rate yourself to keep cards in rotation.</p>
        </div>
        <div class="controls-row">
          <label>
            Track
            <select id="flashcardTrack"></select>
          </label>
          <button id="loadFlashcards" class="primary">Shuffle Deck</button>
          <p class="track-chip" id="flashcardTrackChip" role="status" aria-live="polite">No track selected</p>
        </div>
      </header>

      <div class="flashcard-area" aria-live="polite">
        <div class="flashcard" id="flashcard" tabindex="0">
          <p class="eyebrow" id="flashcardMeta">Select a track to begin.</p>
          <h3 id="flashcardPrompt">No card loaded</h3>
          <div id="flashcardAnswer" class="flashcard-answer" hidden></div>
          <button id="toggleAnswer" class="ghost" disabled>Show answer</button>
        </div>
        <div class="rating-buttons">
          <button id="rateAgain" data-rating="again" disabled>Again</button>
          <button id="rateGood" data-rating="good" disabled>Good</button>
          <button id="rateEasy" data-rating="easy" disabled>Easy</button>
        </div>
        <div class="stats" id="flashcardStats">Progress will appear here.</div>
      </div>
    </section>

    <section id="quizzes" class="view" aria-labelledby="quizzes-heading">
      <header class="section-header">
        <div>
          <h2 id="quizzes-heading">Quizzes</h2>
          <p>Multiple choice drills with instant feedback and explanations.</p>
        </div>
        <div class="controls-row">
          <label>
            Track
            <select id="quizTrack"></select>
          </label>
          <button id="startQuiz" class="primary">New Quiz</button>
          <p class="track-chip" id="quizTrackChip" role="status" aria-live="polite">No track selected</p>
        </div>
      </header>

      <div class="quiz-area" aria-live="polite">
        <div class="quiz-card" id="quizCard">
          <p class="eyebrow" id="quizMeta">Choose a track and start a quiz.</p>
          <h3 id="quizQuestion">No quiz active</h3>
          <div id="quizChoices" class="choices"></div>
          <div id="quizFeedback" class="quiz-feedback" hidden></div>
          <button id="nextQuestion" class="ghost" disabled>Next question</button>
        </div>
        <div class="stats" id="quizStats">Scoreboard will appear here.</div>
        <div class="adaptive-tools">
          <p class="adaptive-note" id="quizFocusHint" role="status" aria-live="polite">Adaptive focus: build a baseline to unlock targeted quizzes.</p>
          <button class="ghost subtle-button" type="button" id="resetAdaptiveButton">Reset adaptive data</button>
        </div>
      </div>
    </section>

    <section id="pbqs" class="view" aria-labelledby="pbqs-heading">
      <header class="section-header">
        <div>
          <h2 id="pbqs-heading">Performance Labs</h2>
          <p>Simulate CompTIA-style PBQs: arrange steps, match tools, or enter the exact command.</p>
        </div>
        <div class="controls-column">
          <label>
            Scenario
            <select id="pbqSelect"></select>
          </label>
          <div class="pbq-controls">
            <div class="pbq-nav-buttons">
              <button id="prevPbq" class="ghost">Previous</button>
              <button id="nextPbq" class="ghost">Next</button>
            </div>
            <div class="pbq-action-buttons">
              <button id="pbqReset" class="ghost">Reset</button>
              <button id="pbqCheck" class="primary">Check answer</button>
            </div>
          </div>
          <p class="track-chip" id="pbqProgress" role="status" aria-live="polite">No scenario loaded</p>
        </div>
      </header>

      <div class="upgrade-banner" id="pbqLockNotice" role="status" hidden>
        <div>
          <p class="eyebrow">Pro feature</p>
          <h3>Unlock the full PBQ lab</h3>
          <p>Free tier includes <strong><span id="pbqLimitCount">3</span> PBQs</strong>. Upgrade to access <span id="pbqLockedCount">0</span> more scenarios plus future labs.</p>
        </div>
        <div class="upgrade-banner-actions">
          <button class="primary" data-upgrade="true" data-upgrade-label="Unlock PBQ lab" data-upgrade-thanks="Pro unlocked">Unlock PBQ lab</button>
        </div>
      </div>

      <div class="redeem-card" id="redeemCard">
        <div>
          <p class="eyebrow">Already upgraded?</p>
          <h3>Redeem your unlock code</h3>
          <p id="redeemHint">Enter the code from your receipt to activate Pro on this device.</p>
        </div>
        <form id="redeemForm" class="redeem-form" autocomplete="off">
          <label for="redeemCode">Unlock code</label>
          <div class="redeem-form-row">
            <input type="text" id="redeemCode" name="redeemCode" placeholder="Enter code" inputmode="text" aria-describedby="redeemFeedback" />
            <button type="submit" class="primary">Redeem</button>
          </div>
          <p class="redeem-feedback" id="redeemFeedback" role="status" aria-live="polite"></p>
        </form>
      </div>

      <div class="pbq-area" aria-live="polite">
        <article class="pbq-card" id="pbqCard">
          <p class="eyebrow" id="pbqSource"></p>
          <h3 id="pbqTitle">Choose a scenario to begin.</h3>
          <p id="pbqPrompt"></p>
          <div id="pbqWorkspace"></div>
          <div class="pbq-feedback" id="pbqFeedback" hidden></div>
        </article>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <small>Science-backed CompTIA drills by Trifecta. Add custom packs by dropping JSON files into <code>docs/questions</code>.</small>
    <span id="versionTag" class="version-tag" aria-live="polite"></span>
  </footer>

  <script src="firebase-config.js" defer></script>
  <script type="module" src="app.js"></script>
</body>
</html>
